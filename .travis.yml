language: python

dist: xenial

cache:
  pip: true

python:
  - 3.6
  - 3.7
  - 3.8

services:
  - docker

install:
  - "python -m pip install --upgrade pip"
  - "pip install ."
  - "pip install --upgrade .[test]"

matrix:
  include:
    # https://docs.travis-ci.com/user/reference/osx#using-macos
    - name: "CoreML artifact (minimal)"
      os: osx
      osx_image: xcode12
      language: minimal
      install:
        - ./travis/install_python36_osx.sh
        - export PATH=${HOME}/miniconda/bin:${PATH}
        - hash -r
        - python -m pip install --upgrade pip
        - pip install .
        - pip install --upgrade .[test]
      script:
        - ./travis/coreml_integration_tests.sh

script:
  - ./travis/unit_tests.sh

after_success:
  - codecov

