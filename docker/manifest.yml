---
header: |
  # ===========================================
  #
  # THIS IS A GENERATED DOCKERFILE DO NOT EDIT.
  #
  # ===========================================

# http://yaml.org/type/merge.html
repository:
  docker.io:
    only_if: HUB_PASSWORD
    user: HUB_USERNAME
    pwd: HUB_PASSWORD
    registry:
      model-server: "bentoml/model-server"
      yatai-service: "bentoml/yatai-service"

packages:
  model-server:
    devel: &default_specs
      - ubuntu
      - centos
    cudnn:
      - *default_specs
      - amazonlinux
    runtime:
      - *default_specs
      - amazonlinux
      - slim
      - alpine
  yatai-service:
    runtime:
      - *default_specs

dependencies:
  cuda:
    v11.3.1: &cuda11_3_1_deps
      cudart:
        version: 11.3.109-1
      cudnn8:
        version: 8.2.0.53-1
      libcublas:
        version: 11.5.1.109-1
      libcurand:
        version: 10.2.4.109-1
      libcusparse:
        version: 11.6.0.109-1
      libcufft:
        version: 10.4.2.109-1
      libcusolver:
        version: 11.1.2.109-1

release_spec: &tmpl_spec
  templates_dir: ""
  envars: &global_env
    - LANG=C.UTF-8
    - LC_ALL=C.UTF-8
    - PYTHONDONTWRITEBYTECODE=1
  base_image: ""
  add_to_tags: ""
  cuda:
    <<: *cuda11_3_1_deps

releases:
  ubuntu:
    20.04: &ubuntu
      <<: *tmpl_spec
      templates_dir: templates/debian
      base_image: ubuntu:20.04
      add_to_tags: "ubuntu20.04"
    18.04:
      <<: *ubuntu
      base_image: ubuntu:18.04
      add_to_tags: "ubuntu18.04"
  slim:
    buster:
      <<: *ubuntu
      base_image: debian:buster-slim
      add_to_tags: "slim"
      cuda:
  centos:
    8: &centos
      <<: *tmpl_spec
      templates_dir: templates/rhel
      base_image: centos:8
      add_to_tags: "centos8"
    7:
      <<: *centos
      base_image: centos:7
      add_to_tags: "centos7"
  amazonlinux:
    2:
      <<: *centos
      base_image: amazonlinux:2
      add_to_tags: "ami2"
  alpine:
    3.14:
      <<: *tmpl_spec
      templates_dir: templates/alpine
      base_image: alpine:3.14
      add_to_tags: "alpine"